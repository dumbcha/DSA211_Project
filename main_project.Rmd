---
title: "DSA211_Project"
output: html_document
date: "2023-02-16"
format: html
editor_options: 
  markdown: 
    wrap: 90
---

# Scenario

Based on 2022 Singapore HDB resale price (real-life) data sets, your team is supposed to
construct a multiple regression model (for one particular district) to explain the HDB
resale price (ResalePrice) in dollars with the given independent variables.

-   Date: Transaction Month
-   Type: HDB Types (3-, 4- or 5-room flats)
-   Block: Block Number of Flat
-   Street: Flat's Street Location
-   Story: Flat's Story
-   Area: Size in Squared Meters
-   Model: Flat's Model
-   LeaseBegin: Year of Lease Start
-   LeaseRemain: Period of Lease Remaining

## Marking Criteria

Documentation and Presentation: 10 marks

Methodology: 10 marks

R-codes, computer outputs interpretation and graphical explanations: 15 marks

Recommendations and conclusions: 15 marks

## Format:

Written Report: PDF Format: Within 10pages excluding the cover page and Appendix

Appendix: codes with computer outputs

You are required to provide the detailed documentation of how you search your recommended
model for inference purpose and justify each step in your data analysis. You are also
expected to provide model assumption justification and hypothesis testing evidences
(R-codes and computer outputs) with clear explanations that your recommended model is the
best model among all the models considered according to BIC criterion. Based on your final
recommended model, state clearly your recommendations and conclusions.

# Part 1 of Project

Load Data In

```{r, echo = FALSE}
options(width = 100, wrap = "none")

library(dplyr)
```

```{r}
Sengkang <- read.csv("data/Sengkang2023P.csv", stringsAsFactors = TRUE)

head(Sengkang, 5)
```

From the regression above, we know that there are too many categorical variables to
consider. We have to condense them accordingly.

```{r}
length(unique(Sengkang$Block))
length(unique(Sengkang$Street))
length(unique(Sengkang$LeaseRemain))
```

We can see from the code chunk above that block will have 521, street has 29 and
LeaseRemain has 226 categorical variables

```{r}
L1 <- lm(ResalePrice ~ ., data = Sengkang)
BIC(L1)
```

We will first calculate the BIC of the regression of all variables.

Hypothetically, Block and Street are related to each other due to location and proximity.
We will drop Block and calculate the BIC.

```{r}
L2 <- lm(ResalePrice ~. -Block, data = Sengkang)
BIC(L2)
```

We notice that BIC for regression L2 decrease, suggesting that it is a better model. As
Street still has a number of categorical variables, we will try to condense that even
further. Proximity within the Sengkang district should be relatively small and should not
affect.

```{r}
df <- read.csv("data/hdb-property-information.csv")

property_info <- df %>%
  filter(bldg_contract_town == "SK") %>%
  dplyr::select(blk_no, street)
```

condensed_Sengkang \<- Sengkang %\>%
 \
group_by(Street) %\>% 

mutate(neighborhood = ifelse(Street == ))

Variables to get rid of: Block, Date, Lease-begin

LM1 : Run all variables LM2: Model\*Area LM3: LM4: Area

LM4.

# Data Wrangling

```{r}
df <- Sengkang %>%
  mutate(Date = lubridate::ym(Date),
         LeaseBegin = lubridate::ym( paste0(LeaseBegin,"-01")),
         years_used = as.numeric((Date - LeaseBegin)/365))
```

Using leaseremain as a factor will generate too many binary variables. Convert them into
years_used would be easier. Date and LeaseBegin variables must be in date type before
substracting between the two. The output would be in (drtn) days and thus we have to set
it to numeric set to years.

# Run Regression

```{r}
reg_all <- lm(ResalePrice ~ ., data = df)
summary(reg_all)
```

```{r}
BIC(reg_all)
```
